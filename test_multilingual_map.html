<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ°å›³å¤šè¨€èªå¯¾å¿œãƒ†ã‚¹ãƒˆ - å›½æ——ã‚ã¦ã‚²ãƒ¼ãƒ </title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="styles.css">
    <style>
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-controls {
            margin: 10px 0;
        }
        .test-controls button {
            margin: 5px;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            background: #007bff;
            color: white;
            cursor: pointer;
        }
        .test-controls button:hover {
            background: #0056b3;
        }
        .language-selector {
            margin: 10px 0;
        }
        .language-selector button {
            margin: 5px;
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
            background: white;
            cursor: pointer;
        }
        .language-selector button.active {
            background: #28a745;
            color: white;
        }
        #world-map {
            height: 400px;
            width: 100%;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .test-log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 10px;
            margin: 10px 0;
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        .log-success { color: #28a745; }
        .log-error { color: #dc3545; }
        .log-info { color: #17a2b8; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>åœ°å›³å¤šè¨€èªå¯¾å¿œãƒ†ã‚¹ãƒˆ</h1>
        <p>ã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ã€åœ°å›³è¡¨ç¤ºã®å¤šè¨€èªå¯¾å¿œæ©Ÿèƒ½ã‚’ç¢ºèªã—ã¾ã™ã€‚</p>

        <div class="test-section">
            <h2>è¨€èªãƒ¢ãƒ¼ãƒ‰é¸æŠ</h2>
            <div class="language-selector">
                <button onclick="setLanguageMode('hiragana')" id="btn-hiragana">ã²ã‚‰ãŒãª</button>
                <button onclick="setLanguageMode('japanese')" id="btn-japanese" class="active">æ—¥æœ¬èª</button>
                <button onclick="setLanguageMode('english')" id="btn-english">English</button>
            </div>
            <p>ç¾åœ¨ã®è¨€èªãƒ¢ãƒ¼ãƒ‰: <span id="current-language">japanese</span></p>
        </div>

        <div class="test-section">
            <h2>åœ°å›³è¡¨ç¤º</h2>
            <div id="world-map"></div>
        </div>

        <div class="test-section">
            <h2>ãƒ†ã‚¹ãƒˆæ“ä½œ</h2>
            <div class="test-controls">
                <button onclick="testHighlightJapan()">æ—¥æœ¬ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ</button>
                <button onclick="testHighlightUSA()">ã‚¢ãƒ¡ãƒªã‚«ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ</button>
                <button onclick="testHighlightFrance()">ãƒ•ãƒ©ãƒ³ã‚¹ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ</button>
                <button onclick="testShowCountryInfo()">å›½æƒ…å ±è¡¨ç¤ºãƒ†ã‚¹ãƒˆ</button>
                <button onclick="testMapControls()">åœ°å›³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ†ã‚¹ãƒˆ</button>
                <button onclick="clearMap()">åœ°å›³ã‚’ã‚¯ãƒªã‚¢</button>
            </div>
        </div>

        <div class="test-section">
            <h2>ãƒ†ã‚¹ãƒˆçµæœ</h2>
            <div id="test-log" class="test-log"></div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="js/game.js"></script>
    <script src="js/countryService.js"></script>
    <script src="js/map.js"></script>

    <script>
        // Test data
        const testCountries = {
            japan: {
                name: {
                    common: "Japan",
                    japanese: "æ—¥æœ¬",
                    hiragana: "ã«ã»ã‚“"
                },
                cca2: "JP",
                flag: "ğŸ‡¯ğŸ‡µ",
                latlng: [36.0, 138.0],
                capital: {
                    english: ["Tokyo"],
                    japanese: ["æ±äº¬"],
                    hiragana: ["ã¨ã†ãã‚‡ã†"]
                },
                region: {
                    english: "Asia",
                    japanese: "ã‚¢ã‚¸ã‚¢",
                    hiragana: "ã‚ã˜ã‚"
                },
                subregion: {
                    english: "Eastern Asia",
                    japanese: "æ±ã‚¢ã‚¸ã‚¢",
                    hiragana: "ã²ãŒã—ã‚ã˜ã‚"
                },
                population: 125836021,
                area: 377930
            },
            usa: {
                name: {
                    common: "United States",
                    japanese: "ã‚¢ãƒ¡ãƒªã‚«åˆè¡†å›½",
                    hiragana: "ã‚ã‚ã‚Šã‹ãŒã£ã—ã‚…ã†ã“ã"
                },
                cca2: "US",
                flag: "ğŸ‡ºğŸ‡¸",
                latlng: [37.0902, -95.7129],
                capital: {
                    english: ["Washington, D.C."],
                    japanese: ["ãƒ¯ã‚·ãƒ³ãƒˆãƒ³D.C."],
                    hiragana: ["ã‚ã—ã‚“ã¨ã‚“ã§ãƒãƒ¼ã—ãƒ¼"]
                },
                region: {
                    english: "Americas",
                    japanese: "ã‚¢ãƒ¡ãƒªã‚«å¤§é™¸",
                    hiragana: "ã‚ã‚ã‚Šã‹ãŸã„ã‚Šã"
                },
                subregion: {
                    english: "North America",
                    japanese: "åŒ—ã‚¢ãƒ¡ãƒªã‚«",
                    hiragana: "ããŸã‚ã‚ã‚Šã‹"
                },
                population: 331002651,
                area: 9833517
            },
            france: {
                name: {
                    common: "France",
                    japanese: "ãƒ•ãƒ©ãƒ³ã‚¹",
                    hiragana: "ãµã‚‰ã‚“ã™"
                },
                cca2: "FR",
                flag: "ğŸ‡«ğŸ‡·",
                latlng: [46.0, 2.0],
                capital: {
                    english: ["Paris"],
                    japanese: ["ãƒ‘ãƒª"],
                    hiragana: ["ã±ã‚Š"]
                },
                region: {
                    english: "Europe",
                    japanese: "ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘",
                    hiragana: "ã‚ˆãƒ¼ã‚ã£ã±"
                },
                subregion: {
                    english: "Western Europe",
                    japanese: "è¥¿ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘",
                    hiragana: "ã«ã—ã‚ˆãƒ¼ã‚ã£ã±"
                },
                population: 67391582,
                area: 643801
            }
        };

        // Initialize game state for testing
        const gameState = {
            languageMode: 'japanese',
            currentCountry: null
        };

        // Initialize map
        let mapInitialized = false;

        function initializeTestMap() {
            if (!mapInitialized) {
                const success = initializeMap();
                if (success) {
                    mapInitialized = true;
                    log('åœ°å›³ãŒåˆæœŸåŒ–ã•ã‚Œã¾ã—ãŸ', 'success');
                } else {
                    log('åœ°å›³ã®åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
                }
            }
        }

        // Language mode functions
        function setLanguageMode(mode) {
            gameState.languageMode = mode;
            document.getElementById('current-language').textContent = mode;
            
            // Update button states
            document.querySelectorAll('.language-selector button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(`btn-${mode}`).classList.add('active');
            
            // Update map controls language
            if (typeof updateMapControlsLanguage === 'function') {
                updateMapControlsLanguage();
            }
            
            log(`è¨€èªãƒ¢ãƒ¼ãƒ‰ã‚’ ${mode} ã«å¤‰æ›´ã—ã¾ã—ãŸ`, 'info');
        }

        // Test functions
        function testHighlightJapan() {
            gameState.currentCountry = testCountries.japan;
            if (typeof highlightCountry === 'function') {
                highlightCountry('JP', testCountries.japan.latlng, gameState.languageMode);
                log(`æ—¥æœ¬ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆã—ã¾ã—ãŸ (${gameState.languageMode}ãƒ¢ãƒ¼ãƒ‰)`, 'success');
            } else {
                log('highlightCountryé–¢æ•°ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“', 'error');
            }
        }

        function testHighlightUSA() {
            gameState.currentCountry = testCountries.usa;
            if (typeof highlightCountry === 'function') {
                highlightCountry('US', testCountries.usa.latlng, gameState.languageMode);
                log(`ã‚¢ãƒ¡ãƒªã‚«ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆã—ã¾ã—ãŸ (${gameState.languageMode}ãƒ¢ãƒ¼ãƒ‰)`, 'success');
            } else {
                log('highlightCountryé–¢æ•°ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“', 'error');
            }
        }

        function testHighlightFrance() {
            gameState.currentCountry = testCountries.france;
            if (typeof highlightCountry === 'function') {
                highlightCountry('FR', testCountries.france.latlng, gameState.languageMode);
                log(`ãƒ•ãƒ©ãƒ³ã‚¹ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆã—ã¾ã—ãŸ (${gameState.languageMode}ãƒ¢ãƒ¼ãƒ‰)`, 'success');
            } else {
                log('highlightCountryé–¢æ•°ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“', 'error');
            }
        }

        function testShowCountryInfo() {
            if (typeof showCountryInfo === 'function') {
                showCountryInfo(testCountries.japan, testCountries.japan.latlng, gameState.languageMode);
                log(`å›½æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã—ãŸ (${gameState.languageMode}ãƒ¢ãƒ¼ãƒ‰)`, 'success');
            } else {
                log('showCountryInfoé–¢æ•°ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“', 'error');
            }
        }

        function testMapControls() {
            const labels = getLocalizedLabels(gameState.languageMode);
            log(`åœ°å›³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®ãƒ©ãƒ™ãƒ« (${gameState.languageMode}):`, 'info');
            log(`- ã‚ºãƒ¼ãƒ ã‚¤ãƒ³: ${labels.zoomIn}`, 'info');
            log(`- ã‚ºãƒ¼ãƒ ã‚¢ã‚¦ãƒˆ: ${labels.zoomOut}`, 'info');
            log(`- ãƒªã‚»ãƒƒãƒˆ: ${labels.reset}`, 'info');
            log(`- é¦–éƒ½: ${labels.capital}`, 'info');
            log(`- åœ°åŸŸ: ${labels.region}`, 'info');
        }

        function clearMap() {
            if (typeof clearHighlight === 'function') {
                clearHighlight();
            }
            if (typeof resetMapView === 'function') {
                resetMapView();
            }
            log('åœ°å›³ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ', 'info');
        }

        // Logging function
        function log(message, type = 'info') {
            const logElement = document.getElementById('test-log');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = `log-${type}`;
            logEntry.textContent = `[${timestamp}] ${message}`;
            logElement.appendChild(logEntry);
            logElement.scrollTop = logElement.scrollHeight;
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', () => {
            log('åœ°å›³å¤šè¨€èªå¯¾å¿œãƒ†ã‚¹ãƒˆã‚’é–‹å§‹ã—ã¾ã™', 'info');
            initializeTestMap();
            
            // Test basic functionality
            setTimeout(() => {
                log('åŸºæœ¬æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™...', 'info');
                
                // Test language mode functions
                if (typeof getCountryName === 'function') {
                    const japanName = getCountryName(testCountries.japan, 'japanese');
                    log(`getCountryName ãƒ†ã‚¹ãƒˆ: ${japanName}`, 'success');
                } else {
                    log('getCountryNameé–¢æ•°ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“', 'error');
                }
                
                if (typeof getLocalizedLabels === 'function') {
                    const labels = getLocalizedLabels('japanese');
                    log(`getLocalizedLabels ãƒ†ã‚¹ãƒˆ: ${labels.capital}`, 'success');
                } else {
                    log('getLocalizedLabelsé–¢æ•°ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“', 'error');
                }
                
                log('ãƒ†ã‚¹ãƒˆæº–å‚™å®Œäº†ã€‚ä¸Šã®ãƒœã‚¿ãƒ³ã§å„æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¦ãã ã•ã„ã€‚', 'success');
            }, 1000);
        });
    </script>
</body>
</html>